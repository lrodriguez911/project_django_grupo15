{% extends './base.html' %}

{% block titulo %}Turnos de Pacientes{% endblock%}

{% block content %}
<h1 class="mt-4">Turnos</h1>
<ol class="breadcrumb mb-4">
    <li class="breadcrumb-item"><a href="{% url 'home_pac' %}">Portal de Pacientes</a></li>
    <li class="breadcrumb-item active">Turnos</li>
</ol>

<div class="card">
 
    <script>

      function mostrarSeleccionado(radioButton) {
        var seleccionado = radioButton.value;
        if (seleccionado == "Por calendario") {
          document.getElementById('calendario').style.display = 'block';
          document.getElementById('disponibilidad').style.display = 'none';
        }else {
          document.getElementById('calendario').style.display = 'none';
          document.getElementById('disponibilidad').style.display = 'block';
        }


        {% comment %} document.getElementById('resultado').textContent = 'Seleccionaste: ' + seleccionado; {% endcomment %}
      }


//      {% comment %} <script> {% endcomment %}
        // Obtener las especialidades mediante una llamada a la API
        fetch('/especialidades/')
          .then(response => response.json())
          .then(data => {
            const dropdown = document.getElementById('disponibilidad');
      
            // Agregar las opciones al dropdown
            data.especialidades.forEach(especialidad => {
              const option = document.createElement('option');
              option.value = especialidad.id_especiality;
              option.text = especialidad.name_especiality;
              dropdown.appendChild(option);
            });
          })
          .catch(error => {
            console.error('Error al obtener las especialidades:', error);
          });
      

          
          <select id="especialidad-dropdown" name="especialidad">
            <!-- Las opciones se agregarán dinámicamente mediante JavaScript -->
          </select>
          
          <script>
            // Obtener el elemento select del dropdown
            const dropdown = document.getElementById('especialidad-dropdown');
          
            // Función para agregar una opción al dropdown
            function agregarOpcion(value, text) {
              const option = document.createElement('option');
              option.value = value;
              option.text = text;
              dropdown.appendChild(option);
            }
          
            // Realizar una llamada a la API para obtener las especialidades
            fetch('/especialidades/')
              .then(response => response.json())
              .then(data => {
                // Recorrer las especialidades y agregar las opciones al dropdown
                data.especialidades.forEach(especialidad => {
                  agregarOpcion(especialidad.id_especiality, especialidad.name_especiality);
                });
              })
              .catch(error => {
                console.error('Error al obtener las especialidades:', error);
              });
          </script>
          





          <select class="form-control" id="lista_especialidades">
            {% for Especialidad in Especialidades %}
                <option value="{{ Especialidad.id_especiality }}">{{ Especialidad.name_especiality }}</option>
            {% endfor %}
        </select>
        
    
          <select id="disponibilidad" name="especialidad">
        <!-- Las opciones se agregarán dinámicamente mediante JavaScript -->
      </select>
      En este ejemplo, el código JavaScript realiza una llamada a la URL /especialidades/ para obtener las especialidades en formato JSON. Luego, agrega las opciones al dropdown utilizando los datos obtenidos.
      
      Recuerda ajustar los nombres de las variables y las ubicaciones de acuerdo a tu proyecto y estructura de archivos.
      
      Con estos ajustes, deberías poder incluir las especialidades en la página de turnos de tu aplicación Django.
      
      
      
      
      
      


    </script>
 
 
    <div class="card-header">
      Turnos Medicos
    </div>
    {% comment %} <div class="card-body">
      <h5 class="card-title">Paciente</h5>
      <p class="card-text">Seleccione Especialidad - Profesional - Dia y Horario.</p>
      <a href="{% url 'home_pac' %}" class="btn btn-primary">Volver</a>
    </div>
  {% endcomment %}
    <div class="card">
        <div class="card-header">
          <h5 class="card-title">Paciente  {{user.get_username}} </h5>
        <div class="container">
          <h5>Selecciona como querés ver tu turno</h5>
          <div class="form-group">
            <label>Selecciona una opción:</label>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="opcion" id="opcion1" value="Por calendario" onchange="mostrarSeleccionado(this)">
              <label class="form-check-label" for="opcion1">Por Calendario</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="opcion" id="opcion2" value="Por disponibilidad" onchange="mostrarSeleccionado(this)">
              <label class="form-check-label" for="opcion2">Por disponibilidad</label>
            </div>
            <div class="form-group">
              <label>Botón seleccionado:</label>
              <p id="resultado"></p>
            </div>
        </div>
      </div>
      <div class="container mt-5" id="calendario" style="display: none;">
        <div class="row" id="calendar">
        </div>
      </div>
    
    {% comment %} {{ include './lista_especialidades.html'}} {% endcomment %}
    
    
      {% comment %} {% comment %} <div class="container mt-5" id="disponibilidad" style="display: none;"> {% endcomment %}
          {% comment %} <div class="row">  {% endcomment %}
            {% comment %} <select class="form-control" id='lista_especialidades'> {% endcomment %}
              {% comment %} <h5>ppp</h5> {% endcomment %}
              {% comment %} {% for Especialidad in Especialidades %} {% endcomment %}
                  {% comment %} <option value="{{ Especialidad.id_especiality }}">{{ Especialidad.name_especiality }}</option> {% endcomment %}
              {% comment %} {% endfor %} {% endcomment %}
          {% comment %} </select> {% endcomment %}
            {% comment %} {% include './lista_especialidades.html' %} {% endcomment %}
            {% comment %} {{ lista_especialidades }} {% endcomment %}
            {% comment %} {% load lista_especialidades %} {% endcomment %}
            {% comment %} {% block titulo %}Turnos de Pacientes{% endblock%} {% endcomment %}
            {% comment %} {% block lista_especialidades %} especialidad{%endblock%} {% endcomment %}
        </div>
      </div>
      <div class="card-body">
          
          <p class="card-text">Seleccione Especialidad - Profesional - Dia y Horario.</p>
          <a href="{% url 'home_pac' %}" class="btn btn-primary">Volver</a>
        </div>
    </div>





</div>
{% endblock content %}